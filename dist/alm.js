!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){(function(global){"use strict";!function(root,factory){"object"==typeof exports?module.exports=factory(root):"function"==typeof define&&define.amd?define(factory):root=factory(root)}(global.window,function(Public){function Signal(fn,receivers){this.fn=fn,this.receivers="undefined"!=typeof receivers?receivers:[]}function setupMailboxes(runtime){return function(base){var signal=Signal.make(),sig_id=runtime.addInput(signal),mb={signal:signal,send:function(v){runtime.async(function(){runtime.notify(sig_id,v)})}};return mb.send(base),mb}}function setupPorts(runtime){var inbound=function(name){var signal=Signal.make(),sig_id=runtime.addInput(signal);return runtime.ports[name]={send:function(v){runtime.notify(sig_id,v)}},signal},outbound=function(name){var signal=Signal.make();return runtime.ports[name]={listen:function(k){signal.recv(k)}},signal};return{inbound:inbound,outbound:outbound}}function setupVdom(alm){function VTree(content,children,type){this.content=content,this.children=children,this.type=type,this.type===VTree.Text?this.key=this.content:"undefined"!=typeof this.content.attrs.id?this.key=this.content.attrs.id:this.key=null}function makeDOMNode(tree){if(null===tree)return null;if(tree.type===VTree.Text)return document.createTextNode(tree.content);var el=document.createElement(tree.content.tag);for(var key in tree.content.attrs)el.setAttribute(key,tree.content.attrs[key]);for(var i=0;i<tree.children.length;i++){var child=makeDOMNode(tree.children[i]);el.appendChild(child)}return tree.mailbox&&tree.mailbox.send(el),el}function initialDOM(tree){for(var root=alm.domRoot,domTree=makeDOMNode(tree);root.firstChild;)root.removeChild(root.firstChild);root.appendChild(domTree)}function diff(a,b,dom){if("undefined"==typeof b||null==b)return void(dom&&dom.parentNode.removeChild(dom));if("undefined"==typeof a||null==a)return void dom.appendChild(makeDOMNode(b));if(b.type===VTree.Node)if(a.type===VTree.Node)if(a.content.tag===b.content.tag){for(var attr in b.content.attrs)dom[attr]=b.content.attrs[attr],dom.setAttribute(attr,b.content.attrs[attr]);for(var _attr in a.content.attrs)_attr in b.content.attrs||dom.removeAttribute(_attr);for(var aLen=a.children.length,bLen=b.children.length,len=aLen>bLen?aLen:bLen,kids=new Array,i=0;i<len;i++)kids.push(dom.childNodes[i]);for(var _i=0;_i<len;_i++){var kidA=a.children[_i],kidB=b.children[_i];kidA?diff(kidA,kidB,kids[_i]):diff(null,kidB,dom)}}else{var p=dom.parentNode;p.insertBefore(makeDOMNode(b),dom),p.removeChild(dom)}else{var _p=dom.parentNode;_p.insertBefore(makeDOMNode(b),dom),_p.removeChild(dom)}else{var _p2=dom.parentNode;_p2.insertBefore(makeDOMNode(b),dom),_p2.removeChild(dom)}}var vdom={};return VTree.prototype={subscribe:function(mailbox){return this.mailbox=mailbox,this},keyEq:function(other){var me=this;return null!=me.key&&null!=other.key&&me.key===other.key}},VTree.Text=0,VTree.Node=1,vdom.el=function(tag,attrs,children){var children_trees="undefined"==typeof children?[]:children.map(function(kid){return"string"==typeof kid?new VTree(kid,[],VTree.Text):kid});return new VTree({tag:tag,attrs:attrs},children_trees,VTree.Node)},vdom.render=function(view_signal){view_signal.reduce(null,function(update,tree){var root=alm.domRoot;return null===tree?initialDOM(update):diff(tree,update,root.firstChild),update}).done()},vdom}function App(runApp){this.runApp=runApp}function save(modified){return new App(function(runtime){if(runtime)for(var key in runtime)key in modified||(modified[key]=runtime[key]);return{value:void 0,runtime:Object.freeze(modified)}})}function setupEvents(runtime){function setupEvent(evtName,sig){var sig_id=runtime.addInput(sig);runtime.addListener([sig],runtime.eventRoot,evtName,function(evt){runtime.notify(sig_id,evt)})}var events={mouse:{click:Signal.make(),dblclick:Signal.make()},keyboard:{keypress:Signal.make(),keydown:Signal.make(),keyup:Signal.make(),blur:Signal.make(),focusout:Signal.make()},input:Signal.make(),change:Signal.make(),load:Signal.make()};return setupEvent("click",events.mouse.click),setupEvent("dblclick",events.mouse.dblclick),setupEvent("keypress",events.keyboard.keypress),setupEvent("keydown",events.keyboard.keydown),setupEvent("keyup",events.keyboard.keyup),setupEvent("focusout",events.keyboard.focusout),setupEvent("blur",events.keyboard.blur),setupEvent("input",events.input),setupEvent("change",events.change),setupEvent("load",events.load),events}var loeb=require("./loeb.js"),instance=loeb.instance,Functor=loeb.Functor,Monad=loeb.Monad,guid_factory=(loeb.constant,loeb.id,loeb.guid_factory);Public.loeb=loeb;Public.guid=guid_factory();return Signal.make=function(){return new Signal(function(x){return x},[])},Signal.constant=function(x){return new Signal(function(_){return x})},Signal.output=function(handler){var sig=new Signal(function(v){handler(v)},[]);return sig.isOutput=!0,sig},Signal.prototype={send:function(timestamp,value){var result=this.fn(value);if(void 0!==result&&!this.isOutput)for(var i=this.receivers.length;i--;)this.receivers[i].send(timestamp,result)},connect:function(receiver){return this.receivers.push(receiver),this},addReceivers:function(receivers){this.receivers.concat(receivers)},receive:function(upstream){return upstream.receivers.push(this),this},filter:function(cond){var r=new Signal(function(v){if(cond(v))return v});return this.connect(r),r},reduce:function(initial,reducer){var state=initial,r=new Signal(function(v){return state=reducer(v,state)});return this.connect(r),r},map:function(f){var r=new Signal(function(v){return f(v)});return this.connect(r),r},recv:function(f){var s=new Signal.output(f);return this.connect(s),s},done:function(){return this}},Public.Signal={make:Signal.make,output:Signal.output,constant:Signal.constant},Public.App=App,App.of=function(v){var value="undefined"!=typeof v?v:null;return new App(function(runtime){return{value:value,runtime:runtime}})},App.save=save,App.init=function(_cfg){function setTimeout(fn,delay){return window.setTimeout(fn,delay)}function async(fn){return window.setTimeout(fn,0)}function addListener(whichInputs,dom,evtName,fn){dom.addEventListener(evtName,fn,!0);var listener={whichInputs:whichInputs,dom:dom,evtName:evtName,fn:fn};listeners.push(listener)}function notify(inputId,v){if(updating)throw new Error("Update already in progress!");updating=!0;var timestamp=timer.now();inputs[inputId].send(timestamp,v),updating=!1}function addInput(inp){var _id=inputs.length;return inputs.push(inp),_id}function byId(_id){return document.getElementById(_id)}function prune(){for(var l=listeners.length-1;l>=0;l--){for(var listener=listeners[l],unused_count=0,i=0;i<listener.whichInputs.length;i++){var inp=listener.whichInputs[i];0===inp.receivers.length&&unused_count++}listener.whichInputs.length===unused_count&&(cfg.eventRoot.removeEventListener(listener.evtName,listener.fn),listeners.splice(l,1))}}var cfg=void 0;if("undefined"==typeof _cfg)cfg={domRoot:document.body,eventRoot:document,gui:!0};else if("string"==typeof _cfg)cfg={domRoot:document.getElementById(_cfg),eventRoot:document.getElementById(_cfg),gui:!0};else{if("object"!=typeof _cfg)throw new Exception("Invalid configuration value!");cfg=_cfg,cfg.domRoot="undefined"==typeof _cfg.domRoot?document.body:document.getElementById(cfg.domRoot),cfg.eventRoot="undefined"==typeof _cfg.eventRoot?document:document.getElementById(cfg.eventRoot),cfg.gui="undefined"==typeof _cfg.gui||_cfg.gui}var listeners=[],inputs=[],ports={},timer={programStart:Date.now(),now:function(){return Date.now()}},updating=!1,mailbox=setupMailboxes({addInput:addInput,async:async,notify:notify}),vdom=null;cfg.gui&&(vdom=setupVdom({byId:byId,domRoot:cfg.domRoot,mailbox:mailbox}));var port=setupPorts({addInput:addInput,ports:ports,notify:notify,mailbox:mailbox}),events=setupEvents({addInput:addInput,eventRoot:cfg.eventRoot,addListener:addListener,notify:notify});return save({gui:cfg.gui,domRoot:cfg.domRoot,eventRoot:cfg.eventRoot,timer:timer,addInput:addInput,addListener:addListener,notify:notify,setTimeout:setTimeout,events:events,async:async,mailbox:mailbox,byId:byId,port:port,vdom:vdom,ports:ports,prune:prune,scope:{}})},App.prototype={map:function(f){var me=this;return new App(function(runtime){var prev=me.runApp(runtime);return{value:f(prev.value),runtime:prev.runtime}})},flatten:function(){var me=this;return new App(function(runtime){var prev=me.runApp(runtime),inner=prev.value.runApp(prev.runtime);return inner})},runtime:function(k){return this.then(function(_){return new App(function(runtime){return{value:runtime,runtime:runtime}})}).then(k)},setup:function(k){return this.runtime(function(rt){return save(k(rt))})},main:function(k){return this.runtime(function(runtime){var alm={events:runtime.events,async:runtime.async,setTimeout:runtime.setTimeout,byId:runtime.byId,mailbox:runtime.mailbox,port:runtime.port,scope:runtime.scope,el:runtime.vdom.el,timer:runtime.timer},view=k(alm);return runtime.gui&&runtime.vdom.render(view),runtime.prune(),save(alm)})},start:function(){var runtime=this.runApp().runtime;return{ports:runtime.ports,scope:runtime.scope}}},instance(App,Functor),instance(App,Monad),Public})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./loeb.js":2}],2:[function(require,module,exports){"use strict";!function(root,factory){"object"==typeof exports?module.exports=factory(root):"function"==typeof define&&define.amd?define(factory):root=factory(root)}(this,function(module){var memothunk=module.memothunk=function(f){var result,cached=!1;return function(){return cached?result:(cached=!0,result=f())}},instance=(module.constant=function(y){return function(){return y}},module.id=function(x){return x},module.compose=function(f,g){return function(x){return f(g(x))}},module.guid_factory=function(){var count=0;return function(){return count++}},module.instance=function(inst,klass){for(var fn in klass.prototype)inst.prototype[fn]=klass.prototype[fn]}),Functor=module.Functor=function(){};Functor.prototype={force:function(){return this.map(function(x){return x()})},delay:function(){return this.map(function(x){return memothunk(function(){return x})})}};var Monad=module.Monad=function(){};Monad.prototype.flatMap=Monad.prototype.then=function(f){return this.map(f).flatten()},Monad.prototype.then=Monad.prototype.flatMap;module.flatten=function(monad){return monad.flatten()};Monad.prototype.ap=function(other){var me=this;return me.flatMap(function(f){return other.flatMap(function(x){return me.constructor.of(f(x)).delay()})})},Array.prototype.flatten=function(){return this.reduce(function(a,b){return a.concat(b)},[])},Array.of||(Array.of=function(){return Array.prototype.slice.call(arguments)}),instance(Array,Functor),instance(Array,Monad);var Comonad=module.Comonad=function(){};return Comonad.prototype.convolve=function(f){return this.duplicate().map(f)},module})},{}]},{},[1]);