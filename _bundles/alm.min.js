!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("alm",[],e):"object"==typeof exports?exports.alm=e():t.alm=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,n){"use strict";function r(t){var e=Object.keys(t);return function(n,r){for(var o=!1,i={},s=0;s<e.length;s++){var a=e[s],u=t[a],c=n[a],d=u(c,r);i[a]=d,o=o||d!==c}return o?i:n}}function o(t,e,n){return void 0===e&&(e={}),void 0===n&&(n=[]),function(r){var o={};e.on&&(o=e.on,delete e.on);var i=n.map(function(t,e){return"string"==typeof t?new a.VDom(t,[],a.VDomType.Text):t(r)}),s=function(t){return r.handle(t,o)};return"string"==typeof t?new a.VDom({tag:t,attrs:e},i,a.VDomType.Node,s):t(e)(r)}}function i(t,e){return void 0===t&&(t=null),void 0===e&&(e=null),function(n){return function(r){return void 0===r&&(r={}),function(o){var i=o.store,a=i.getState(),u=t?t(a):{},c=e?e(i.dispatch.bind(i)):{},d=s({},r,u,c);return n(d)(o)}}}}var s=this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t};Object.defineProperty(e,"__esModule",{value:!0});var a=n(1);e.makeReducer=r;var u=function(){function t(t,e){this.state=t,this.reducer=e,this.subscribers=[]}return t.prototype.dispatch=function(t){return this.state=this.reducer(this.state,"function"==typeof t?t(this.dispatch.bind(this),this.getState.bind(this)):t),this.subscribers.forEach(function(t){t()}),this},t.prototype.subscribe=function(t){var e=this;return this.subscribers.push(t),function(){var n=e.subscribers.indexOf(t);e.subscribers.splice(n,1)}},t.prototype.getState=function(){return Object.seal(this.state)},t}();e.Store=u,e.el=o;var c=function(){function t(t){this.raw=t,this.classes=t.target.className.trim().split(/\s+/g)||[],this.id=t.target.id||"",this.value=t.target.value}return t.prototype.hasClass=function(t){return-1!==this.classes.indexOf(t)},t.prototype.getClasses=function(){return this.classes},t.prototype.getId=function(){return this.id},t.prototype.getValue=function(){return this.value},t.prototype.class_in_ancestry=function(t){for(var e=null,n=!1,r=this.raw.target;!n;){if(!r.className){n=!0;break}-1!==(r.className.trim().split(/\s+/g)||[]).indexOf(t)?(e=r,n=!0):r.parentNode?r=r.parentNode:n=!0}return e},t}();e.AlmEvent=c;var d=function(){function t(t){this.gensymnumber=0,this.store=new u(t.model,t.update),this.eventRoot="string"==typeof t.eventRoot?document.getElementById(t.eventRoot):void 0===t.eventRoot?document:t.eventRoot,this.domRoot="string"==typeof t.domRoot?document.getElementById(t.domRoot):t.domRoot,this.view=t.view,this.events={}}return t.prototype.start=function(){var t=this;this.events={};var e=this.store,n=function(e,n){var r;e.hasAttribute("data-alm-id")?r=e.getAttribute("data-alm-id"):(r=t.gensym(),e.setAttribute("data-alm-id",r));for(var o in n)o in t.events||(t.events[o]={},t.registerEvent(o,t.handleEvent)),t.events[o][r]=n[o];return function(){for(var e in n)delete t.events[e][r]}},r={store:e,handle:n},o=this.view(r);a.initialDOM(this.domRoot,o),this.store.subscribe(function(){var e=t.view(r);a.diff_dom(t.domRoot,o,e),o=e})},t.prototype.handleEvent=function(t){var e=t.type;if(this.events[e]&&t.target.hasAttribute("data-alm-id")){var n=t.target.getAttribute("data-alm-id");this.events[e][n]&&this.events[e][n](new c(t))}},t.prototype.gensym=function(){return"node-"+(this.gensymnumber++).toString()},t.prototype.registerEvent=function(t,e){this.eventRoot.addEventListener(t,e.bind(this),!0)},t}();e.Alm=d,e.connect=i},function(t,e,n){"use strict";function r(t){if(null===t)return null;if(t.treeType===a.Text)return document.createTextNode(t.content);var e=document.createElement(t.content.tag);for(var n in t.content.attrs)e.setAttribute(n,t.content.attrs[n]);for(var o=0;o<t.children.length;o++){var i=r(t.children[o]);e.appendChild(i)}return t.onDestroy=t.onCreate(e),e}function o(t,e){for(var n=t,o=r(e);n.firstChild;)n.removeChild(n.firstChild);n.appendChild(o)}function i(t,e,n){if(!t.length)return e.map(function(t){return[c.Insert,null,t]});if(!e.length)return t.map(function(t){return[c.Delete,t,null]});for(var r=t.length+1,o=e.length+1,i=new Array(r*o),s=[],a=0;a<r;a++)i[a*o]=a;for(var u=0;u<o;u++)i[u]=u;for(var d=1;d<o;d++)for(var l=1;l<r;l++)n(t[l-1],e[d-1])?i[l*o+d]=i[(l-1)*o+(d-1)]:i[l*o+d]=Math.min(i[(l-1)*o+d],i[l*o+(d-1)])+1;for(var f=r-1,h=o-1;0!==f||0!==h;)n(t[f-1],e[h-1])?(f--,h--,s.unshift([c.Merge,t[f],e[h]])):i[f*o+(h-1)]<=i[(f-1)*o+h]?(h--,s.unshift([c.Insert,null,e[h]])):(f--,s.unshift([c.Delete,t[f],null]));return s}function s(t,e,n,o){if(void 0===o&&(o=0),void 0===n||null===n)return t.childNodes[o].onDestroy&&t.childNodes[o].onDestroy(),void t.removeChild(t.childNodes[o]);if(void 0===e||null===e)return void t.insertBefore(r(n),t.childNodes[o]);if(n.treeType===a.Node){if(e.treeType===a.Node&&e.content.tag===n.content.tag){var u=t.childNodes[o];for(var d in e.content.attrs)d in n.content.attrs||(u.removeAttribute(d),delete u[d]);for(var d in n.content.attrs){var l=n.content.attrs[d];d in e.content.attrs&&l===e.content.attrs[d]||(u[d]=l,u.setAttribute(d,l))}for(var f=i(e.children,n.children,function(t,e){return void 0!==t&&t.eq(e)}),h=0,v=0;v<f.length;v++){var p=f[v];s(t.childNodes[o],p[1],p[2],h),p[0]!==c.Delete&&h++}}}else t.childNodes[o].onDestroy&&t.childNodes[o].onDestroy(),t.replaceChild(r(n),t.childNodes[o])}Object.defineProperty(e,"__esModule",{value:!0});var a;!function(t){t[t.Text=0]="Text",t[t.Node=1]="Node"}(a=e.VDomType||(e.VDomType={}));var u=function(){function t(t,e,n,r){void 0===r&&(r=null),this.content=t,this.children=e,this.treeType=n,this.onCreate=r,this.onDestroy=null,n===a.Node?"key"in this.content.attrs?(this.key=this.content.attrs.key,delete this.content.attrs.key):"id"in this.content.attrs?this.key=this.content.attrs.id:this.key=this.content.tag:this.key="text-node"}return t.prototype.eq=function(t){return!!t&&this.key===t.key},t}();e.VDom=u,e.initialDOM=o;var c;!function(t){t[t.Merge=0]="Merge",t[t.Delete=1]="Delete",t[t.Insert=2]="Insert"}(c||(c={})),e.diff_array=i,e.diff_dom=s}])});